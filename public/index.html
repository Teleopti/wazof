<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" ng-app="wazof">
<head>
    <meta charset="utf-8"/>
    <title>wazof</title>
    <script src="javascripts/angular.min.js"></script>
    <script src="javascripts/ui-bootstrap-tpls-0.12.0.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
    <style type="text/css">
        @media print {
            #non-printable {
                display: none;
            }

            #printable {
                display: block;
            }
        }

        .hidden {
            display: none;
        }

        body {
            background-image: url("images/paysage.jpeg");
            background-size: contain;
            background-repeat: no-repeat;
            min-height: 800px;
        }

    </style>
</head>
<body ng-view ng-controller="main" class="container-fluid">
<div id="non-printable">
    <div><h2 class="h2">This day? I wazof!</h2></div>
    <h4> 1. Fill the fields below : </h4>

    <form class="form-inline" role="form">
        <div class="form-group">
                <label class="sr-only" for="number">number</label>
                <input type="text" class="form-control" id="number" ng-model="employee.number" placeholder="My employee number"/>
            </div>

            <div class="form-group">
                <label class="sr-only" for="name">name</label>
                <input type="text" class="form-control" id="name" ng-model="employee.name" placeholder="My name"/>
            </div>
            <div class="form-group">
                <label class="sr-only" for="month">month</label>
                <input type="text" class="form-control" id="month" ng-model="employee.month" placeholder="Month"/>
            </div>
            <div class="form-group">
                <label class="sr-only" for="year">year</label>
                <input type="text" class="form-control" id="year" ng-model="employee.year" placeholder="Year"/>
            </div>

        <div>
            <h4>2. Click on your vacation days : </h4>
            <table class="table  table-striped table-bordered" ng-click="selectDetails($event)">
                <tr>
                    <td ng-repeat="oneDay in monthDays" ng-bind="oneDay">1</td>
                </tr>
            </table>
        </div>
    </form>
    <button class="generate-report btn btn-default" ng-click="generateVacation()">3. Generate my vacation report
    </button>
    <button class="print-report hidden btn btn-default" ng-click="printVacation()">4. Print my vacation report</button>
</div>

<div id="printable" class="hidden">
    <table class="table">
        <th>
            <tr>
                <td>Name</td>
                <td>Employee number</td>
                <td>Month</td>
                <td>Year</td>
            </tr>
        </th>
        <tbody>
        <tr>
            <td ng-bind="employee.name"></td>
            <td ng-bind="employee.number"></td>
            <td ng-bind="employee.month"></td>
            <td ng-bind="employee.year"></td>
        </tr>
        </tbody>
    </table>


    <table class="table table-striped table-bordered">
        <tr>
            <td>day</td>
            <td>code</td>
            <td>Time</td>
        </tr>

        <tr ng-repeat="day in vacations">
            <td ng-bind="day.date"></td>
            <td ng-bind="day.code"></td>
            <td>8</td>
        </tr>
    </table>
</div>


<script type="text/ng-template" id="myModalContent.html">
    <div class="modal-header">
        <h3 class="modal-title">Details</h3>
    </div>
    <div class="modal-body">
        <form class="form">
            <div ng-repeat="code in codes">
                <input type="radio" ng-value="code" ng-model="$parent.selectedCode"/> {{code}}
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" ng-click="ok()">OK</button>
        <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
    </div>
</script>

<script type="text/javascript">
    var wazof = angular.module('wazof', ['ui.bootstrap']);
    wazof.controller('main', ['$scope', '$modal', function ($scope, $modal) {
        $scope.employee = {};
        $scope.vacations = [];
        $scope.monthDays = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31];
        $scope.generateVacation = function (e) {
            document.querySelector('#printable').classList.remove('hidden');
            document.querySelector('.print-report').classList.remove('hidden');
        };

        $scope.printVacation = function (e) {
            window.print();
        };

        $scope.selectDetails = function (e) {
            $scope.currentDay = {};
            $scope.currentDay.date = e.target.innerHTML;
            var modalInstance = $modal.open({
                templateUrl: 'myModalContent.html',
                controller: 'ModalInstanceCtrl',
                size: 'sm'
            });

            modalInstance.result.then(function (code) {
                $scope.currentDay.code = code;
                console.log(code);
                $scope.vacations.push($scope.currentDay);
                $scope.currentDay = {};
            }, function () {
                // after
            });
        };
    }]);

    wazof.controller('ModalInstanceCtrl', function ($scope, $modalInstance) { //, items

        $scope.codes = ['1', '2', '3', '4', '5', '6', '7', '8', '9'];
        $scope.selectedCode = '1';

        $scope.ok = function () {
            $modalInstance.close($scope.selectedCode);//$scope.selected.item
        };

        $scope.cancel = function () {
            $modalInstance.dismiss('cancel');
        };
    });


</script>
</body>
</html>